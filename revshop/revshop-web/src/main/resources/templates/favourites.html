<!DOCTYPE html>
<html lang="en"
      xmlns:th="http://www.thymeleaf.org"
      th:replace="~{layout/base :: layout('My Favourites', ~{::section})}">

<section class="container mt-4">

    <div class="d-flex justify-content-between align-items-center mb-4">
        <a th:href="@{/products}"
           class="btn btn-outline-secondary">
            ‚Üê Back to Products
        </a>

        <h2 class="fw-bold">‚ù§Ô∏è My Favourites</h2>

        <a th:href="@{/cart}">
            <button class="btn btn-dark">üõí View Cart</button>
        </a>
    </div>

    <!-- EMPTY STATE -->
    <div th:if="${#lists.isEmpty(favouriteProducts)}"
         class="text-center mt-5">

        <div class="card p-5 shadow-sm border-0">
            <h4 class="fw-bold">Your favourites list is empty</h4>
            <p class="text-muted mt-2">
                Start exploring products and add what you love ‚ù§Ô∏è
            </p>

            <a th:href="@{/products}" class="btn btn-primary mt-3">
                Browse Products
            </a>
        </div>

    </div>

    <!-- PRODUCTS LIST -->
    <div th:if="${!#lists.isEmpty(favouriteProducts)}">

        <div class="row">

            <div class="col-md-4 mb-4"
                 th:each="product : ${favouriteProducts}">

                <div class="card h-100 shadow-sm border-0">

                    <!-- IMAGE -->
                    <img th:src="${product.imageUrl != null} ? @{/images/{img}(img=${product.imageUrl})} : @{/images/no-image.jpg}"
                         class="card-img-top"
                         style="height:220px; object-fit:cover;">

                    <div class="card-body d-flex flex-column">

                        <h5 class="fw-semibold text-truncate"
                            th:text="${product.name}"></h5>

                        <p class="fw-bold text-success fs-5">
                            ‚Çπ <span th:text="${product.price}"></span>
                        </p>

                        <div class="mt-auto">

                            <!-- ADD TO CART -->
                            <form th:action="@{/cart/add}" method="post">
                                <input type="hidden"
                                       name="productId"
                                       th:value="${product.id}">
                                <input type="hidden"
                                       name="quantity"
                                       value="1">

                                <button type="submit"
                                        class="btn btn-success w-100 mb-2">
                                    üõí Add To Cart
                                </button>
                            </form>

                            <!-- REMOVE -->
                            <form th:action="@{/favourite/remove}" method="post">
                                <input type="hidden"
                                       name="productId"
                                       th:value="${product.id}">

                                <button type="submit"
                                        class="btn btn-outline-danger w-100">
                                    Remove
                                </button>
                            </form>

                        </div>

                    </div>

                </div>

            </div>

        </div>

    </div>

</section>

</html>